---
layout: post
title: 'AIS3 Pre-Exam 2017'
tags: 'AIS3 write-up'
date: '2017-07-13'
author: 'racterub'
---

這次是我第一次玩AIS3 Pre-Exam,難度沒有特別難<del>以web來說拉</del>.
解題的時候有卡了一下下<del>實際上是一整天</del>
以下是有解出來的write-up

`FLAG和題目大多都忘記保存了QQ,所以這篇只寫出想法和大概解法QQ`

# MISC

## MISC1
只是個簽到題
## MISC2
<del>這題的出題者給我出來QQ, 這花了我快一天的時間QQ</del>
題目只寫了頁面`I've sent you something :)`
一開始看原始碼一看就看到`<!-- <img src=sudodu.png /> -->`
一開始的只覺得應該是個Stego題
結果不論是用`exiftool`, `binwalk`, `strings`都沒有出現任何特別的地方
直到有一次無聊喵了一下看到header發現有傳了一串類似以base64編碼的字串
解出來後的確是base64編碼的,結果是一個資料夾, 資料夾裡面有一張照片
下載下來即可發現FLAG
FLAG = `AIS3{pika}`

# WEB
## WEB1
題目只寫了`Didn't You See The Flag?`
用curl就會噴FLAG了

## WEB2
題目為一個登入畫面,DB已經寫死在Source Code裡了
看了一下Source Code是
```php
    md5(%password) == $row['password']
```
後來Google了一下,發現是PHP`==`的一些問題
([Source](http://momomoxiaoxi.com/2016/07/07/CTFWeb/#2-md5碰撞))
([CTF實例](http://www.nobbd.de/blog/artikel.php?titel=write-up-Internetwache-CTF-2016---All-5-web-challenges))
並且在DB找到了MD5編碼開頭為0e的密碼
所以以0e編碼的明碼再加上相對應的username就可以取得flag
## WEB3 & WEB4
兩個是同一個網站

### WEB3(Flag1)
看了一下發現好像有LFI的漏洞
就開始不斷的猜flag的位置
<del>猜了快一天</del>
才發現就在index
`payload => $domain/?p=php://filter/convert.base64-encode/resource=index`

### WEB4(Flag2)
看了一下index的內容
發現Flag2的線索
有個`uploaddddddd`的頁面
發現可能是要上傳webshell
但是不論怎麼試都不行過(改content-type, 雙副檔名)
後來才知道要用phar的協定
壓縮webshell成zip檔,改附檔名成.jpg,利用LFI+phar執行webshell
`the_flag2_which_the_filename_you_can_not_guess_without_getting_the_shellllllll1l` 這個頁面就放flag
進去一看就可以看到Flag2

# CRYPTO
## CRYPTO 3
程式碼:`(我不會寫php code QQ(意思有到就好))`
```php
h1 = $_POST["username"]
h2 = $_POST["password"]
if h1 = h2;
    die $flag
```
直覺就是SHA1 Collision
[(Source)](https://shattered.io/)
在網路上改一下script就會噴出flag了
```python
import requests
import urllib2
rotimi = urllib2.urlopen("http://shattered.io/static/shattered-1.pdf").read()[:500]
letmein = urllib2.urlopen("http://shattered.io/static/shattered-2.pdf").read()[:500]
payload = {'username': rotimi, 'password': letmein}
r = requests.post('https://quiz.ais3.org:32670', data=payload)
print r.text
```

# 總結
這次AIS3的初體驗我覺得挺好玩的
<del>雖然只有127名QQ</del>
因為自己Reverse跟pwn的底子還不夠,所以打完web跟misc就不繼續打了
明年希望自己能夠給力點QQ
